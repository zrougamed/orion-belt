"use strict";(globalThis.webpackChunkorion_belt_docs=globalThis.webpackChunkorion_belt_docs||[]).push([[1411],{26306(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"quickstart/initial-connection","title":"Initial Connection","description":"After installing the Orion-Belt server and agent, the next step is to establish the first connection. This ensures that the server can manage the agent, and users can connect through the Orion-Belt gateway.","source":"@site/docs/quickstart/initial-connection.md","sourceDirName":"quickstart","slug":"/quickstart/initial-connection","permalink":"/docs/quickstart/initial-connection","draft":false,"unlisted":false,"editUrl":"https://github.com/zrougamed/orion-belt/tree/main/docs/docs/quickstart/initial-connection.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Initial Connection"},"sidebar":"tutorialSidebar","previous":{"title":"Client Setup","permalink":"/docs/quickstart/client"},"next":{"title":"Guides","permalink":"/docs/category/guides"}}');var i=t(74848),r=t(28453);const o={sidebar_position:8,title:"Initial Connection"},c="Initial Connection: Agent to Server",l={},a=[{value:"1. Overview",id:"1-overview",level:2},{value:"2. Generate SSH Key on Agent",id:"2-generate-ssh-key-on-agent",level:2},{value:"3. Copy Public Key to Server",id:"3-copy-public-key-to-server",level:2},{value:"4. Register Agent on Server",id:"4-register-agent-on-server",level:2},{value:"5. Verify Agent Connectivity",id:"5-verify-agent-connectivity",level:2},{value:"6. Test Connection from Client",id:"6-test-connection-from-client",level:2},{value:"7. Common Issues &amp; FAQ",id:"7-common-issues--faq",level:2},{value:"<code>Connection failed: no route to host</code>",id:"connection-failed-no-route-to-host",level:3},{value:"<code>User client does not exist on agent</code>",id:"user-client-does-not-exist-on-agent",level:3},{value:"<code>SSH authentication failed</code>",id:"ssh-authentication-failed",level:3},{value:"8. Notes",id:"8-notes",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"initial-connection-agent-to-server",children:"Initial Connection: Agent to Server"})}),"\n",(0,i.jsxs)(n.p,{children:["After installing the Orion-Belt ",(0,i.jsx)(n.strong,{children:"server"})," and ",(0,i.jsx)(n.strong,{children:"agent"}),", the next step is to establish the first connection. This ensures that the server can manage the agent, and users can connect through the Orion-Belt gateway."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,i.jsx)(n.p,{children:"The initial connection process consists of:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Generating SSH keys"})," on the agent."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Copying the public key to the server"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Registering the agent"})," on the server."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Testing connectivity"})," from client to agent via the server."]}),"\n"]}),"\n",(0,i.jsx)(n.mermaid,{value:"flowchart LR\n    User[Client User] --\x3e|SSH via osh| Server[Orion-Belt Server]\n    Server --\x3e|Manages| Agent[Agent Machine]\n    Agent --\x3e|Registers| Server"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-generate-ssh-key-on-agent",children:"2. Generate SSH Key on Agent"}),"\n",(0,i.jsxs)(n.p,{children:["Each agent machine needs its ",(0,i.jsx)(n.strong,{children:"unique SSH key"}),". On the agent:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Switch to root or use sudo\nsudo su -\n\n# Generate an Ed25519 key for Orion-Belt agent\nssh-keygen -t ed25519 -f /etc/orion-belt/agent_key -N ""\n'})}),"\n",(0,i.jsx)(n.p,{children:"This will create:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Private key: ",(0,i.jsx)(n.code,{children:"/etc/orion-belt/agent_key"})]}),"\n",(0,i.jsxs)(n.li,{children:["Public key: ",(0,i.jsx)(n.code,{children:"/etc/orion-belt/agent_key.pub"})]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," Never share the private key. Only the server needs the public key."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-copy-public-key-to-server",children:"3. Copy Public Key to Server"}),"\n",(0,i.jsx)(n.p,{children:"The server needs the agent's public key to authenticate it."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# On agent machine\nscp /etc/orion-belt/agent_key.pub server_user@server_ip:/tmp/agent_key.pub\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"server_user"})," and ",(0,i.jsx)(n.code,{children:"server_ip"})," with your server's username and IP address."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-register-agent-on-server",children:"4. Register Agent on Server"}),"\n",(0,i.jsx)(n.p,{children:"On the server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Register the agent\norion-belt-server agent register \\\n  --name agent-01 \\\n  --key "$(cat /tmp/agent_key.pub)" \\\n  --hostname 192.168.0.102 \\\n  --port 22 \\\n  --tags environment=production,role=web\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Explanation of parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--name"})," \u2192 Unique name for the agent in the Orion-Belt system."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--key"})," \u2192 Agent's public key."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--hostname"})," \u2192 The agent's IP or hostname reachable by the server."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--port"})," \u2192 SSH port of the agent (default ",(0,i.jsx)(n.code,{children:"22"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--tags"})," \u2192 Metadata to identify the agent (optional)."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Expected output:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Agent registered successfully:\n  Name:       agent-01\n  Machine ID: uuid-xxxx-xxxx\n  Hostname:   192.168.0.102\n  Port:       22\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-verify-agent-connectivity",children:"5. Verify Agent Connectivity"}),"\n",(0,i.jsx)(n.p,{children:"After registration, start the agent service on the agent machine:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl start orion-belt-agent\nsudo systemctl enable orion-belt-agent\n"})}),"\n",(0,i.jsx)(n.p,{children:"On the server, check agent status:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"orion-belt-server agent list\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Output example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"NAME       HOSTNAME       PORT  STATUS   LAST SEEN\nagent-01   192.168.0.102 22    online   2026-01-09 12:30:00\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-test-connection-from-client",children:"6. Test Connection from Client"}),"\n",(0,i.jsx)(n.p,{children:"From a client machine:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"osh agent-01 -u client -c /etc/orion-belt/client.yaml\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-u client"})," \u2192 Orion-Belt username."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-c"})," \u2192 Path to the client configuration."]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"If successful, you should see an interactive shell connected to the agent via the server."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"7-common-issues--faq",children:"7. Common Issues & FAQ"}),"\n",(0,i.jsx)(n.h3,{id:"connection-failed-no-route-to-host",children:(0,i.jsx)(n.code,{children:"Connection failed: no route to host"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure agent hostname/IP is reachable from the server."}),"\n",(0,i.jsxs)(n.li,{children:["Check firewall rules allowing port ",(0,i.jsx)(n.code,{children:"22"})," or the custom SSH port."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"user-client-does-not-exist-on-agent",children:(0,i.jsx)(n.code,{children:"User client does not exist on agent"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create the same user on the agent machine that matches the Orion-Belt username."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo adduser client\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ssh-authentication-failed",children:(0,i.jsx)(n.code,{children:"SSH authentication failed"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Ensure the ",(0,i.jsx)(n.strong,{children:"private key exists"})," on the agent at ",(0,i.jsx)(n.code,{children:"/etc/orion-belt/agent_key"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Ensure the public key was registered correctly on the server."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"8-notes",children:"8. Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Each agent must have a ",(0,i.jsx)(n.strong,{children:"unique SSH key"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Server stores only the ",(0,i.jsx)(n.strong,{children:"public key"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Tags help with filtering agents and grouping machines for access policies."}),"\n"]}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Server\n    participant Agent\n\n    Client->>Server: Connect using osh client\n    Server->>Agent: Forward SSH connection\n    Agent--\x3e>Server: SSH handshake\n    Server--\x3e>Client: Interactive shell established"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Next Steps:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Add users and grant permissions using ",(0,i.jsx)(n.strong,{children:"User Management"})," guide."]}),"\n",(0,i.jsxs)(n.li,{children:["Start recording sessions for compliance (see ",(0,i.jsx)(n.strong,{children:"Session Recording"})," guide)."]}),"\n",(0,i.jsx)(n.li,{children:"Automate agent registration for multiple machines."}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453(e,n,t){t.d(n,{R:()=>o,x:()=>c});var s=t(96540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);